<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>LIVE TV - INCO</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <style>
    body { margin:0; background:#f0e8ff; font-family:'VT323', 'Helvetica Neue', sans-serif; color:#333; }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    a { text-decoration: none; color: inherit; }
    header { background:#fff; border-bottom: 2px solid #000; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-size: 24px; font-weight:bold; }
    .header-actions { display: flex; align-items: center; gap: 16px; }
    .header-actions button { font-family: inherit; background: #ffc2e2; color: #000; border: 2px solid #000; padding: 8px 14px; font-weight: bold; cursor: pointer; box-shadow: 2px 2px 0 #000; }
    .header-actions .upload-btn { background: #a6f0c6; }
    .section-title { font-size: 32px; margin: 40px 0 20px; }
    .channel-carousel { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px; scrollbar-width: thin; }
    .channel-card { background: #fff; border: 2px solid #000; min-width: 280px; transition: all .2s ease; }
    /* [ìˆ˜ì •] position: relative ì¶”ê°€ */
    .channel-card { position: relative; background: #fff; border: 2px solid #000; min-width: 280px; transition: all .2s ease; }
    .channel-card:hover { transform: translateY(-4px); box-shadow: 8px 8px 0 #000; }
    .channel-card .thumbnail { background: #ddd; height: 160px; border-bottom: 2px solid #000; display: flex; align-items: center; justify-content: center; font-size: 24px; color: #888;}
    .channel-card .info { padding: 16px; }
    .channel-card .title { font-size: 20px; margin: 0 0 8px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .channel-card .streamer { font-size: 18px; color: #555; }
    
    /* [ì‹ ê·œ] ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .delete-btn {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 24px;
        height: 24px;
        background: #ff6b6b;
        color: #fff;
        border: 2px solid #000;
        border-radius: 50%;
        font-family: inherit;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo"><a href="livetv.html">LIVE TV</a></div>
    <div class="header-actions">
      <span id="welcome-user" style="font-size: 18px;"></span>
      <span id="berry-balance-display" style="font-size: 18px;"></span>
      <button onclick="location.href='livetv-berries.html'">+ ì—´ë§¤ ì¶©ì „</button>
      <button class="upload-btn" onclick="location.href='upload.html'">ì—…ë¡œë“œ</button>
    </div>
  </header>
  <div class="container">
    <section>
      <h2 class="section-title">ì‹¤ì‹œê°„ ë°©ì†¡ ì¤‘</h2>
      <div class="channel-carousel" id="live-list"></div>
    </section>
    <section>
      <h2 class="section-title">ì£¼ê°„ TOP 10</h2>
      <div class="channel-carousel" id="top-list"></div>
    </section>
  </div>
  <script>
     const nickname = localStorage.getItem('liveTvNickname');
    if (!nickname) {
      window.location.href = 'livetv-login.html';
    }
    
    const initialVideos = [
        { id: 'live01', title: 'SDA ì „íˆ¬ ë¶€ì„œ Q&A', streamer: 'SDA ì „ ì§ì›', file: 'live-qa.html', isLive: true },
        { id: 'live02', title: 'í”„ë¡œì íŠ¸: ì„¸ë¼í”„ ë‹¬ë ¤ë´…ì‹œë‹¤!', streamer: 'Gamer', file: 'live-game.html', isLive: true },
        { id: 'live03', title: 'ì´ˆë³´ ìƒì¡´ ê°€ì´ë“œ', streamer: 'ìƒì¡´ì „ë¬¸ê°€', file: 'live-survival.html', isLive: true },
        { id: 'vod01', title: '[REPLAY] ì§€ì„±ì²´ íƒì‚¬ ë§ˆì§€ë§‰ ê¸°ë¡', streamer: 'DangerChaser', file: 'live-chat-log.html', isLive: false },
        { id: 'vod02', title: 'ì˜›ë‚  ì§€êµ¬ ì´ì•¼ê¸° í•´ë“œë¦½ë‹ˆë‹¤', streamer: 'Old_Timer', file: 'live-history.html', isLive: false },
        { id: 'vod03', title: '[VOD] ë”œëŸ° ë¸Œë£©ìŠ¤ë¥¼ ë§Œë‚˜ë‹¤', streamer: 'Citizen_K', file: 'live-dylan.html', isLive: false },
        { id: 'vod04', title: '[VOD] ì• ì‰¬ ë¦¬ë“œí¬ë“œ ê³¼ê±° í­ë¡œ', streamer: 'í”„ë¡œê³ ë°œëŸ¬', file: 'live-ash.html', isLive: false }
    ];

    // [ì‹ ê·œ] ì‚­ì œ ì²˜ë¦¬ í•¨ìˆ˜
    function handleDelete(event) {
        event.preventDefault();
        event.stopPropagation();

        if (confirm('ì •ë§ë¡œ ì´ ë°©ì†¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            const videoId = event.target.dataset.videoId;
            let allVideos = JSON.parse(localStorage.getItem('liveTvVideos'));
            
            // idê°€ ë¬¸ìì—´ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¹„êµ ì—°ì‚°ì ìˆ˜ì •
            allVideos = allVideos.filter(video => video.id.toString() !== videoId);
            
            localStorage.setItem('liveTvVideos', JSON.stringify(allVideos));
            renderLiveTvPage(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
        }
    }

    // [ìˆ˜ì •] í˜ì´ì§€ ì „ì²´ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” í•¨ìˆ˜
    function renderLiveTvPage() {
        document.getElementById('welcome-user').textContent = `${nickname}ë‹˜`;
        const berries = parseInt(localStorage.getItem('liveTvBerries') || '0');
        document.getElementById('berry-balance-display').textContent = `ğŸ“ ${berries.toLocaleString()}`;

        const allVideos = JSON.parse(localStorage.getItem('liveTvVideos'));

        const liveList = document.getElementById('live-list');
        const topList = document.getElementById('top-list');
        liveList.innerHTML = '';
        topList.innerHTML = '';

        const createVideoCardHTML = (video) => {
            // ë‚´ê°€ ì˜¬ë¦° ì˜ìƒì—ë§Œ ì‚­ì œ ë²„íŠ¼ ì¶”ê°€
            const deleteButton = (video.streamer === nickname) 
                ? `<button class="delete-btn" data-video-id="${video.id}">X</button>` 
                : '';

            return `
              <div class="channel-card">
                ${deleteButton}
                <a href="${video.file || '#'}">
                  <div class="thumbnail">PREVIEW</div>
                  <div class="info">
                    <div class="title">${video.title}</div>
                    <div class="streamer">${video.streamer}</div>
                  </div>
                </a>
              </div>
            `;
        };
        
        const liveVideos = allVideos.filter(video => video.isLive === true);
        const topVideos = allVideos.filter(video => video.isLive === false);

        liveVideos.forEach(video => {
            liveList.innerHTML += createVideoCardHTML(video);
        });

        topVideos.forEach(video => {
            topList.innerHTML += createVideoCardHTML(video);
        });

        // [ì‹ ê·œ] ìƒˆë¡œ ìƒì„±ëœ ì‚­ì œ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.querySelectorAll('.delete-btn').forEach(button => {
            button.addEventListener('click', handleDelete);
        });
    }

    window.onload = () => {
        if (!localStorage.getItem('liveTvVideos')) {
            localStorage.setItem('liveTvVideos', JSON.stringify(initialVideos));
        }
        renderLiveTvPage(); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì „ì²´ ë Œë”ë§
    };
  </script>
</body>
</html>